## Go test 命令行参数

## 控制编译的参数

### -args

指示go test把-args后面的参数带到测试中去。具体的测试函数会跟据此参数来控制测试流程。

-args后面可以附带多个参数，所有参数都将以字符串形式传入，每个参数做为一个string，并存放到字符串切片中。

### -json

-json 参数用于指示go test将结果输出转换成json格式，以方便自动化测试解析使用。

### -o <file>

-o 参数指定生成的二进制可执行程序，并执行测试，测试结束不会删除该程序。

没有此参数时，go test生成的二进制可执行程序存放到临时目录，执行结束便删除。

## 控制测试的参数

### -bench regexp

go test默认不执行性能测试，使用-bench参数才可以运行，而且只运行性能测试函数。

其中正则表达式用于筛选所要执行的性能测试。如果要执行所有的性能测试，使用参数"-bench ."或"-bench=."。

此处的正则表达式不是严格意义上的正则，而是种包含关系。

### -benchtime <t>s

-benchtime指定每个性能测试的执行时间，如果不指定，则使用默认时间1s。

### -cpu 1,2,4

-cpu 参数提供一个CPU个数的列表，提供此列表后，那么测试将按照这个列表指定的CPU数设置GOMAXPROCS并分别测试。

### -count n

-count指定每个测试执行的次数，默认执行一次。

### -failfast

默认情况下，go test将会执行所有匹配到的测试，并最后打印测试结果，无论成功或失败。

-failfast指定如果有测试出现失败，则立即停止测试。这在有大量的测试需要执行时，能够更快的发现问题。

### -list regexp

-list 只是列出匹配成功的测试函数，并不真正执行。而且，不会列出子函数。

### -parallel n

指定测试的最大并发数。

当测试使用t.Parallel()方法将测试转为并发时，将受到最大并发数的限制，默认情况下最多有GOMAXPROCS个测试并发，其他的测试只能阻塞等待。

### -run regexp

跟据正则表达式执行单元测试和示例测试。正则匹配规则与-bench 类似。

### -timeout d

默认情况下，测试执行超过10分钟就会超时而退出。

设置超时可以按秒、按分和按时：

- 按秒设置：-timeout xs或-timeout=xs
- 按分设置：-timeout xm或-timeout=xm
- 按时设置：-timeout xh或-timeout=xh

### -v

默认情况下，测试结果只打印简单的测试结果，-v 参数可以打印详细的日志。

性能测试下，总是打印日志，因为日志有时会影响性能结果。

### -benchmem

默认情况下，性能测试结果只打印运行次数、每个操作耗时。使用-benchmem则可以打印每个操作分配的字节数、每个操作分配的对象数。

#### -cover

 开启测试覆盖率

#### -run regexp 

只运行 regexp 匹配的函数，例如 -run=Array 那么就执行包含有 Array 开头的函数



单元测试使用 go test 命令启动

## 基准测试

基准测试可以测试一段程序的运行性能及耗费 CPU 的程度。Go 语言中提供了基准测试框架，使用方法类似于单元测试，使用者无须准备高精度的计时器和各种分析工具，基准测试本身即可以打印出非常标准的测试报告。

```
-bench=.
```

以 Benchmark 开头的基准测试用例函数

通过`-benchtime`参数可以自定义测试时间

命令行中添加`-benchmem`参数以显示内存分配情况